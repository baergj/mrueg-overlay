From 414c9f2a2f94e210faef57b4b80819009f5d0470 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Manuel=20R=C3=BCger?= <manuel@rueg.eu>
Date: Thu, 20 Nov 2014 21:09:17 +0100
Subject: [PATCH] Add configure options for spell packages.


diff --git a/configure.ac b/configure.ac
index 45abd19..dda4d58 100644
--- a/configure.ac
+++ b/configure.ac
@@ -670,6 +670,10 @@ if test "x$with_glibmm_2_32" = "xyes"; then
 	AC_DEFINE(WITH_GLIBMM_2_32,1,[Build with Glibmm 2.32 or higher])
 fi
 
+
+AC_ARG_WITH([gtkspell],
+	AS_HELP_STRING([--without-gtkspell], [disable gtk spelling widget]),[with_gtkspell=$withval], [with_gtkspell=yes])
+
 dnl *********************************
 dnl   Allow experimental GTK+3 build
 dnl *********************************
@@ -681,11 +685,13 @@ with_gtkmm_3_0="no"
 if test "x$enable_gtk3" = "xyes"; then
 
 	ink_spell_pkg=
-	if pkg-config --exists gtkspell-3.0; then
-		ink_spell_pkg=gtkspell-3.0
-		AC_DEFINE(WITH_GTKSPELL, 1, [enable gtk spelling widget])
+	if test "x$with_gtkspell" = "xyes"; then
+		if pkg-config --exists gtkspell-3.0; then
+			ink_spell_pkg=gtkspell-3.0
+			AC_DEFINE(WITH_GTKSPELL, 1, [enable gtk spelling widget])
+		fi
 	fi
-
+	
 	PKG_CHECK_MODULES(GTK,
 			  gtkmm-3.0 >= 3.2
 			  gdkmm-3.0 >= 3.2
@@ -758,11 +764,13 @@ if test "x$enable_gtk3" = "xyes"; then
 else
 
 	ink_spell_pkg=
-	if pkg-config --exists gtkspell-2.0; then
-		ink_spell_pkg=gtkspell-2.0
-		AC_DEFINE(WITH_GTKSPELL, 1, [enable gtk spelling widget])
+	if test "x$with_gtkspell" = "xyes"; then
+		if pkg-config --exists gtkspell-2.0; then
+			ink_spell_pkg=gtkspell-2.0
+			AC_DEFINE(WITH_GTKSPELL, 1, [enable gtk spelling widget])
+		fi
 	fi
-
+	
 	PKG_CHECK_MODULES(GTK,
 			  gtk+-2.0  >= 2.24
 			  $ink_spell_pkg
@@ -886,12 +894,17 @@ AC_CHECK_HEADER(popt.h,
 dnl **************************
 dnl Check for aspell 
 dnl ******************************
-AC_CHECK_LIB(aspell, new_aspell_config, [AC_CHECK_HEADER(aspell.h, aspell_ok=yes, aspell_ok=no)], aspell_ok=no, -lz -lm)
-if test "x$aspell_ok" = "xyes"; then
-	AC_DEFINE(HAVE_ASPELL, 1, [Use aspell for built-in spellchecker])
-  INKSCAPE_LIBS="$INKSCAPE_LIBS -laspell"
-else
-	AC_MSG_CHECKING([Aspell not found, spell checker will be disabled])
+AC_ARG_WITH([aspell],
+	AS_HELP_STRING([--without-aspell], [disable aspell spell checker]),[with_aspell=$withval], [with_aspell=yes])
+
+if test "x$with_aspell" = "xyes"; then
+	AC_CHECK_LIB(aspell, new_aspell_config, [AC_CHECK_HEADER(aspell.h, aspell_ok=yes, aspell_ok=no)], aspell_ok=no, -lz -lm)
+	if test "x$aspell_ok" = "xyes"; then
+		AC_DEFINE(HAVE_ASPELL, 1, [Use aspell for built-in spellchecker])
+		INKSCAPE_LIBS="$INKSCAPE_LIBS -laspell"
+	else
+		AC_MSG_CHECKING([Aspell not found, spell checker will be disabled])
+	fi
 fi
 
 dnl Check for bind_textdomain_codeset, including -lintl if GLib brings it in.
-- 
2.1.3

